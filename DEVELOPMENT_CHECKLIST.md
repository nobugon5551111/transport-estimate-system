# ✅ 開発・修正作業チェックリスト

## 🎯 使用目的

**このチェックリストは、完成機能を絶対に壊さず、開発負債を安全に管理するための実践的な手順書です。**

---

## 🔒 修正作業開始前チェックリスト

### 📋 Phase 1: 準備・分析（必須）
```
□ 1. 修正対象の明確化
   □ 修正する機能・ファイルを具体的に特定
   □ 修正の目的・期待される結果を明確化
   □ 修正範囲・スコープの決定

□ 2. 影響範囲分析
   □ 完成機能への影響「あり/なし」判定
   □ 依存関係のある機能・ファイルリストアップ
   □ データベース変更の影響確認
   □ API呼び出し・レスポンス形式への影響確認
   □ 既存HTML要素ID・CSSクラス変更の有無確認

□ 3. 保護対象確認
   □ 現在の完成機能リスト確認
      □ Step1: 顧客・案件選択機能
      □ Step2: 配送先入力機能  
      □ Step3: 車両選択機能
      □ Step4: スタッフ入力機能（動的ラベル更新含む）
      □ Step5: その他サービス機能（養生作業フロア計算含む）
      □ Step6: 内容確認・PDF出力機能
      □ マスターデータAPI連携機能
      □ データベース構造・マイグレーション
   □ 今回修正で影響を受ける可能性のある完成機能特定

□ 4. バックアップ・復旧準備
   □ 現在のローカル状態確認・保存
   □ 最新GitHubコミット状態確認
   □ ロールバック手順の確認・準備
   □ 緊急復旧用バックアップファイル確認
```

---

## 🛠️ 修正作業中チェックリスト

### 📋 Phase 2: 安全実装（必須）
```
□ 5. 実装戦略
   □ 新機能は独立したファイル・関数で実装
   □ 既存コードの変更は最小限に限定
   □ 完成機能のコアロジック変更回避
   □ データベーススキーマ変更は追加のみ（削除・変更禁止）

□ 6. 段階的実装
   □ 小さな単位での段階的実装
   □ 各段階での動作確認・テスト実行
   □ 問題発生時の即座停止・原因分析
   □ 中間バックアップポイントの設定

□ 7. コード品質確保
   □ TypeScript型安全性確保
   □ エラーハンドリング実装
   □ 適切なログ出力設定
   □ 既存機能との命名規則統一
   □ コメント・ドキュメント追加
```

---

## ✅ 修正作業完了前チェックリスト

### 📋 Phase 3: 包括的検証（必須）
```
□ 8. ビルド・起動確認
   □ npm run build 成功確認
   □ PM2起動成功確認（pm2 start ecosystem.config.cjs）
   □ curl http://localhost:3000 応答確認
   □ コンソールエラー・警告メッセージ確認

□ 9. 完成機能保護テスト（全項目必須）
   □ Step1: 顧客・案件選択機能動作確認
      □ 顧客一覧表示・選択機能
      □ 案件一覧表示・選択機能  
      □ データ保存・sessionStorage確認
   □ Step2: 配送先入力機能動作確認
      □ 配送先入力・保存機能
      □ エリア判定・料金計算機能
   □ Step3: 車両選択機能動作確認
      □ 車両選択・料金計算機能
      □ 複数車両対応・合計計算機能
   □ Step4: スタッフ入力機能動作確認
      □ スタッフ数入力・料金計算機能
      □ 動的ラベル更新機能（マスターデータ連携）
      □ AI最適化提案機能
   □ Step5: その他サービス機能動作確認  
      □ 各サービス選択・料金計算機能
      □ 養生作業フロア計算機能（基本料金+フロア数×3,000円）
      □ 動的ラベル更新機能（マスターデータ連携）
   □ Step6: 内容確認・PDF出力機能動作確認
      □ 全ステップデータ表示確認
      □ PDF出力機能動作確認
      □ データ保存機能確認

□ 10. API・データベース確認
   □ /api/master-settings エンドポイント応答確認
   □ /api/staff-rates エンドポイント応答確認
   □ データベース接続・クエリ実行確認
   □ マスターデータ取得・表示確認
   □ データ保存・読み込み確認

□ 11. UI/UX動作確認
   □ 全ページ表示・レイアウト確認
   □ フォーム入力・バリデーション確認
   □ ボタン・リンク動作確認
   □ エラーメッセージ・警告表示確認
   □ レスポンシブデザイン確認

□ 12. エラーケース・例外処理確認
   □ 不正な入力値での動作確認
   □ ネットワークエラー時の処理確認
   □ データベース接続エラー時の処理確認
   □ API通信エラー時の処理確認
   □ 予期しない操作での安全性確認
```

---

## 🧹 開発負債整理チェックリスト

### 📋 負債整理前チェック（必須）
```
□ 13. 負債整理準備
   □ 整理対象負債の分類・優先順位確認
      □ Critical（即座対応）: セキュリティ・データ損失・システム停止
      □ Major（計画対応）: 重複コード・未使用ライブラリ・設計問題
      □ Minor（余裕時対応）: コードスタイル・変数名・コメント
   □ 整理対象の完成機能への影響分析
   □ 整理計画・スケジュール策定
   □ バックアップ・復旧手順準備

□ 14. 安全整理実行
   □ 一つの負債のみを対象（複数同時整理禁止）
   □ 完成機能に影響しない負債から着手
   □ 段階的整理・中間テスト実行
   □ 問題発生時の即座停止・ロールバック

□ 15. 整理後検証
   □ 全完成機能動作確認（上記9-12項目全実行）
   □ システム全体パフォーマンス確認
   □ 整理効果測定・記録
   □ 次回整理計画への反映
```

---

## 🚨 問題発生時チェックリスト

### 📋 緊急対応手順（必須）
```
□ 16. 完成機能破損発見時
   □ 作業即座中断・現状ローカル保持
   □ 破損範囲・影響機能特定
   □ 破損原因分析・記録
   □ ユーザーへの緊急報告・状況説明

□ 17. 復旧方法選択・実行
   □ 復旧方法検討（バックアップ/Git履歴/手動修正）
   □ 最適復旧手順決定・慎重実行
   □ 復旧後全機能動作確認
   □ データ整合性・API応答確認

□ 18. 再発防止対策
   □ 破損原因根本分析・記録
   □ 予防策検討・実装
   □ チェックリスト・ルール見直し
   □ 同種問題防止策強化
```

---

## 📊 定期健康診断チェックリスト

### 📋 日次確認（推奨）
```
□ 19. 基本動作確認
   □ PM2プロセス正常性確認（pm2 list）
   □ エラーログ監視（pm2 logs --nostream）
   □ 主要API応答時間確認
   □ データベース接続状況確認
```

### 📋 週次確認（推奨）  
```
□ 20. 包括動作確認
   □ 全機能動作テスト実行（9-12項目）
   □ 新規発生負債特定・記録
   □ パフォーマンス測定・前週比較
   □ セキュリティ脆弱性スキャン（npm audit）
```

### 📋 月次確認（推奨）
```
□ 21. 全体健康診断
   □ 完成機能網羅的テスト
   □ 開発負債整理計画見直し
   □ システム全体アーキテクチャ確認  
   □ バックアップ戦略有効性確認
   □ ドキュメント・ルール更新
```

---

## 🎯 品質目標・指標

### 📈 維持すべき品質指標
```
システム安定性:
□ 完成機能破損率: 0% （絶対維持）
□ 重要API応答時間: <500ms
□ ページ読み込み時間: <2s  
□ エラー発生率: <0.1%

開発負債管理:
□ Critical負債: 0件 （常時維持）
□ Major負債処理: 月1件以上
□ 重複ファイル数: 5件以下
□ 未使用依存関係: 0件
```

---

**このチェックリストを毎回確実に実行することで、完成機能を保護し、開発負債を安全に管理し、システム全体の品質を維持できます。**