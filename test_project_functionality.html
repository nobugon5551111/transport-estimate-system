<!DOCTYPE html>
<html>
<head>
    <title>æ¡ˆä»¶ç®¡ç†æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <script>
        function testProjectFunctionality() {
            // çµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®è¦ç´ 
            const output = document.getElementById('output');
            
            function log(message) {
                console.log(message);
                output.innerHTML += message + '<br>';
            }
            
            log('=== æ¡ˆä»¶ç®¡ç†æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            // æ¡ˆä»¶ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
            setTimeout(() => {
                log('ğŸ¯ æ¡ˆä»¶ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯...');
                if (window.MasterManagement && window.MasterManagement.switchTab) {
                    window.MasterManagement.switchTab('projects');
                    log('âœ… æ¡ˆä»¶ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯å®Œäº†');
                    
                    // æ–°è¦æ¡ˆä»¶è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
                    setTimeout(() => {
                        log('ğŸ¯ æ–°è¦æ¡ˆä»¶è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯...');
                        if (window.MasterManagement && window.MasterManagement.openAddProjectModal) {
                            window.MasterManagement.openAddProjectModal();
                            log('âœ… æ–°è¦æ¡ˆä»¶è¿½åŠ ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å®Œäº†');
                            
                            // é¡§å®¢ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
                            setTimeout(() => {
                                log('ğŸ¯ é¡§å®¢ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‚’ç¢ºèª...');
                                const customerSelect = document.getElementById('masterProjectCustomerId');
                                if (customerSelect) {
                                    log(`âœ… é¡§å®¢ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³è¦ç´ è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ (ID: ${customerSelect.id})`);
                                    log(`é¡§å®¢ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ•°: ${customerSelect.options.length}`);
                                    
                                    if (customerSelect.options.length > 1) {
                                        log('âœ… é¡§å®¢ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã™');
                                        for (let i = 1; i < Math.min(6, customerSelect.options.length); i++) {
                                            log(`- é¡§å®¢ ${i}: ${customerSelect.options[i].text} (ID: ${customerSelect.options[i].value})`);
                                        }
                                    } else {
                                        log('âŒ é¡§å®¢ãƒ‡ãƒ¼ã‚¿ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã›ã‚“ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã¿)');
                                        // æ‰‹å‹•ã§é¡§å®¢ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆ
                                        log('ğŸ”„ æ‰‹å‹•ã§é¡§å®¢ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ...');
                                        if (window.MasterManagement && window.MasterManagement.loadCustomersForSelect) {
                                            window.MasterManagement.loadCustomersForSelect();
                                            setTimeout(() => {
                                                log(`å†ãƒã‚§ãƒƒã‚¯ - é¡§å®¢ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ•°: ${customerSelect.options.length}`);
                                            }, 2000);
                                        }
                                    }
                                } else {
                                    log('âŒ é¡§å®¢ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                                }
                                
                                // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ†ã‚¹ãƒˆ
                                setTimeout(() => {
                                    log('ğŸ¯ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ...');
                                    const form = document.getElementById('masterProjectForm');
                                    if (form) {
                                        log('âœ… æ¡ˆä»¶ãƒ•ã‚©ãƒ¼ãƒ è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ');
                                        const onsubmit = form.getAttribute('onsubmit');
                                        if (onsubmit) {
                                            log(`âœ… onsubmitå±æ€§è¨­å®šæ¸ˆã¿: ${onsubmit}`);
                                        } else {
                                            log('âŒ onsubmitå±æ€§ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
                                        }
                                        
                                        // ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã‚’ãƒã‚§ãƒƒã‚¯
                                        const requiredFields = [
                                            'masterProjectCustomerId',
                                            'masterProjectName',
                                            'masterProjectStatus',
                                            'masterProjectPriority'
                                        ];
                                        
                                        requiredFields.forEach(fieldId => {
                                            const field = document.getElementById(fieldId);
                                            if (field) {
                                                log(`âœ… ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ${fieldId} è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`);
                                            } else {
                                                log(`âŒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ${fieldId} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                                            }
                                        });
                                    } else {
                                        log('âŒ æ¡ˆä»¶ãƒ•ã‚©ãƒ¼ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                                    }
                                    
                                    log('=== ãƒ†ã‚¹ãƒˆå®Œäº† ===');
                                }, 1000);
                                
                            }, 3000);
                        } else {
                            log('âŒ openAddProjectModal ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                        }
                    }, 2000);
                } else {
                    log('âŒ MasterManagement.switchTab ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
            }, 1000);
        }
        
        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰å¾Œã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.addEventListener('load', () => {
            setTimeout(testProjectFunctionality, 3000);
        });
    </script>
</head>
<body>
    <h1>æ¡ˆä»¶ç®¡ç†æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
    <div id="output"></div>
    <br>
    <button onclick="testProjectFunctionality()">æ‰‹å‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
    
    <!-- å®Ÿéš›ã®ã‚µã‚¤ãƒˆã‚’iframeå†…ã§é–‹ã„ã¦åŒæ™‚å®Ÿè¡Œ -->
    <iframe src="https://3000-ip60pndnnf5e5cmovjufh-6532622b.e2b.dev/masters" width="100%" height="800"></iframe>
</body>
</html>